/*! For license information please see WeaponPlugin.modern.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("WeaponPlugin",[],e):"object"==typeof exports?exports.WeaponPlugin=e():t.WeaponPlugin=e()}(window,(function(){return function(t){var e={};function i(r){if(e[r])return e[r].exports;var n=e[r]={i:r,l:!1,exports:{}};return t[r].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(r,n,function(e){return t[e]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);var r=i(1);i.d(e,"Weapon",(function(){return r.default}));var n=i(67);i.d(e,"Bullet",(function(){return n.default}));var s=i(68);i.d(e,"consts",(function(){return s.default}));var l=i(69);i.d(e,"events",(function(){return l.default}));var o=i(71);i.d(e,"WeaponPlugin",(function(){return o.default}))},function(t,e,i){"use strict";i.r(e);i(2);var r=i(67),n=i(68),s=i(70),l=i(69);class o extends Phaser.Events.EventEmitter{constructor(t,e,i="",l="",o){super(),this.scene=void 0,this.debugPhysics=!1,this._bullets=void 0,this._autoExpandBulletsGroup=!1,this._autofire=!1,this._shots=0,this._fireLimit=0,this._fireRate=100,this._fireRateVariance=0,this._fireFrom=new Phaser.Geom.Rectangle(0,0,1,1),this._fireAngle=n.Angle.ANGLE_UP,this._bulletInheritSpriteSpeed=!1,this._bulletAnimation="",this._bulletFrameRandom=!1,this._bulletFrameCycle=!1,this._bulletWorldWrap=!1,this._bulletWorldWrapPadding=0,this._bulletAngleOffset=0,this._bulletAngleVariance=0,this._bulletSpeed=200,this._bulletSpeedVariance=0,this._bulletLifespan=0,this._bulletKillDistance=0,this._bulletGravity=new Phaser.Math.Vector2(0,0),this._bulletRotateToVelocity=!1,this._bulletKey=void 0,this._bulletFrame=void 0,this._bulletClass=r.default,this._bulletCollideWorldBounds=!1,this._bulletKillType=n.KillType.KILL_WORLD_BOUNDS,this._data={customBody:!1,width:0,height:0,offsetX:0,offsetY:0},this._bounds=new Phaser.Geom.Rectangle,this._bulletBounds=void 0,this._bulletFrames=[],this._bulletFrameIndex=0,this.anims={},this._trackedSprite=void 0,this._trackedPointer=void 0,this._multiFire=!1,this._hasFired=!1,this._trackRotation=!1,this._trackOffset=new Phaser.Math.Vector2,this._nextFire=0,this._tempNextFire=0,this._rotatedPoint=new Phaser.Math.Vector2,this.logLevel="warn",this.scene=t,this._bulletKey=i,this._bulletFrame=l,this._bulletBounds=this.scene.physics.world.bounds,Object(s.default)(this),this.createBullets(e,i,l,o)}get bullets(){return this._bullets}set bullets(t){this._bullets=t,Object(s.default)(this,"bullets")}get autoExpandBulletsGroup(){return this._autoExpandBulletsGroup}set autoExpandBulletsGroup(t){this._autoExpandBulletsGroup=t,Object(s.default)(this,"autoExpandBulletsGroup")}get autofire(){return this._autofire}set autofire(t){this._autofire=t,Object(s.default)(this,"autofire")}get shots(){return this._shots}set shots(t){this._shots=t,Object(s.default)(this,"shots")}get fireLimit(){return this._fireLimit}set fireLimit(t){this._fireLimit=t,Object(s.default)(this,"fireLimit")}get fireRate(){return this._fireRate}set fireRate(t){this._fireRate=t,Object(s.default)(this,"fireRate")}get fireRateVariance(){return this._fireRateVariance}set fireRateVariance(t){this._fireRateVariance=t,Object(s.default)(this,"fireRateVariance")}get fireFrom(){return this._fireFrom}set fireFrom(t){this._fireFrom=t,Object(s.default)(this,"fireFrom")}get fireAngle(){return this._fireAngle}set fireAngle(t){this._fireAngle=t,Object(s.default)(this,"fireAngle")}get bulletInheritSpriteSpeed(){return this._bulletInheritSpriteSpeed}set bulletInheritSpriteSpeed(t){this._bulletInheritSpriteSpeed=t,Object(s.default)(this,"bulletInheritSpriteSpeed")}get bulletAnimation(){return this._bulletAnimation}set bulletAnimation(t){this._bulletAnimation=t,Object(s.default)(this,"bulletAnimation")}get bulletFrameRandom(){return this._bulletFrameRandom}set bulletFrameRandom(t){this._bulletFrameRandom=t,Object(s.default)(this,"bulletFrameRandom")}get bulletFrameCycle(){return this._bulletFrameCycle}set bulletFrameCycle(t){this._bulletFrameCycle=t,Object(s.default)(this,"bulletFrameCycle")}get bulletWorldWrap(){return this._bulletWorldWrap}set bulletWorldWrap(t){this._bulletWorldWrap=t,Object(s.default)(this,"bulletWorldWrap")}get bulletWorldWrapPadding(){return this._bulletWorldWrapPadding}set bulletWorldWrapPadding(t){this._bulletWorldWrapPadding=t,Object(s.default)(this,"bulletWorldWrapPadding")}get bulletAngleOffset(){return this._bulletAngleOffset}set bulletAngleOffset(t){this._bulletAngleOffset=t,Object(s.default)(this,"bulletAngleOffset")}get bulletAngleVariance(){return this._bulletAngleVariance}set bulletAngleVariance(t){this._bulletAngleVariance=t,Object(s.default)(this,"bulletAngleVariance")}get bulletSpeed(){return this._bulletSpeed}set bulletSpeed(t){this._bulletSpeed=t,Object(s.default)(this,"bulletSpeed")}get bulletSpeedVariance(){return this._bulletSpeedVariance}set bulletSpeedVariance(t){this._bulletSpeedVariance=t,Object(s.default)(this,"bulletSpeedVariance")}get bulletLifespan(){return this._bulletLifespan}set bulletLifespan(t){this._bulletLifespan=t,Object(s.default)(this,"bulletLifespan")}get bulletKillDistance(){return this._bulletKillDistance}set bulletKillDistance(t){this._bulletKillDistance=t,Object(s.default)(this,"bulletKillDistance")}get bulletGravity(){return this._bulletGravity}set bulletGravity(t){this._bulletGravity=t,Object(s.default)(this,"bulletGravity")}get bulletRotateToVelocity(){return this._bulletRotateToVelocity}set bulletRotateToVelocity(t){this._bulletRotateToVelocity=t,Object(s.default)(this,"bulletRotateToVelocity")}get bulletKey(){return this._bulletKey}set bulletKey(t){this._bulletKey=t,Object(s.default)(this,"bulletKey")}get bulletFrame(){return this._bulletFrame}set bulletFrame(t){this._bulletFrame=t,Object(s.default)(this,"bulletFrame")}get bulletClass(){return this._bulletClass}set bulletClass(t){this._bulletClass=t,this.bullets&&(this.bullets.classType=this._bulletClass),Object(s.default)(this,"bulletClass")}get bulletCollideWorldBounds(){return this._bulletCollideWorldBounds}set bulletCollideWorldBounds(t){this._bulletCollideWorldBounds=t,this.bullets.children.each(e=>{e.body.collideWorldBounds=t,e.setData("bodyDirty",!1)}),Object(s.default)(this,"bulletCollideWorldBounds")}get bulletKillType(){return this._bulletKillType}set bulletKillType(t){switch(t){case n.KillType.KILL_STATIC_BOUNDS:case n.KillType.KILL_WEAPON_BOUNDS:this.bulletBounds=this.bounds;break;case n.KillType.KILL_CAMERA_BOUNDS:this.bulletBounds=this.scene.sys.cameras.main.getBounds();break;case n.KillType.KILL_WORLD_BOUNDS:this.bulletBounds=this.scene.physics.world.bounds}this._bulletKillType=t,Object(s.default)(this,"bulletKillType")}get bounds(){return this._bounds}set bounds(t){this._bounds=t,Object(s.default)(this,"bounds")}get bulletBounds(){return this._bulletBounds}set bulletBounds(t){this._bulletBounds=t,Object(s.default)(this,"bulletBounds")}get bulletFrames(){return this._bulletFrames}set bulletFrames(t){this._bulletFrames=t,Object(s.default)(this,"bulletFrames")}get bulletFrameIndex(){return this._bulletFrameIndex}set bulletFrameIndex(t){this._bulletFrameIndex=t,Object(s.default)(this,"bulletFrameIndex")}get trackedSprite(){return this._trackedSprite}set trackedSprite(t){this._trackedSprite=t,Object(s.default)(this,"trackedSprite")}get trackedPointer(){return this._trackedPointer}set trackedPointer(t){this._trackedPointer=t,Object(s.default)(this,"trackedPointer")}get multiFire(){return this._multiFire}set multiFire(t){this._multiFire=t,Object(s.default)(this,"multiFire")}get trackRotation(){return this._trackRotation}set trackRotation(t){this._trackRotation=t,Object(s.default)(this,"trackRotation")}get trackOffset(){return this._trackOffset}set trackOffset(t){this._trackOffset=t,Object(s.default)(this,"trackOffset")}get x(){return this.fireFrom.x}set x(t){this.fireFrom.x=t}get y(){return this.fireFrom.y}set y(t){this.fireFrom.y=t}createBullets(t=1,e,i,r,n){return n&&(this._bulletClass=n),this.bullets&&this.bullets.scene||(this.bullets=this.scene.add.group({classType:this._bulletClass,maxSize:t,runChildUpdate:!0})),0!==t&&(-1===t&&(this.autoExpandBulletsGroup=!0,t=1),this.bullets.createMultiple({key:e,frame:i,repeat:t,active:!1,visible:!1}),this.bullets.children.each(t=>{t.setData("bulletManager",this)}),"string"==typeof e&&(this.bulletKey=e),"string"==typeof i&&this.bulletFrame,r&&r.addMultiple(this.bullets.children.entries)),this}forEach(t,e,...i){return this.bullets.children.each(r=>{r.active&&t.call(e,r,i)}),this}pauseAll(){return this.bullets.children.each(t=>{t.body.enable=!1;const e=t.getData("timeEvent");void 0!==e&&(e.paused=!0)},this),this}resumeAll(){return this.bullets.children.each(t=>{t.body.enable=!0;const e=t.getData("timeEvent");void 0!==e&&(e.paused=!1)},this),this}killAll(){return this.bullets.children.each(t=>{t.active&&t.kill(),t.body.enable=!0}),this}resetShots(t){return this.shots=0,void 0!==t&&(this.fireLimit=t),this}trackSprite(t,e=0,i=0,r=!1){return this.trackedPointer=void 0,this.trackedSprite=t,this.trackRotation=r,this.trackOffset.set(e,i),this}trackPointer(t,e=0,i=0){return void 0===t&&this.scene.input&&(t=this.scene.input.activePointer),this.trackedPointer=t,this.trackedSprite=void 0,this.trackRotation=!1,this.trackOffset.set(e,i),this}fireMany(t,e){this.multiFire=!0;const i=[];return e||this.trackedSprite||this.trackedPointer?t.forEach(t=>{const r=this.fire(e,null,null,t.x,t.y);r&&i.push(r)}):t.forEach(t=>{const e=this.fire(t);e&&i.push(e)}),i}fireOffset(t=0,e=0){return this.fire(null,null,null,t,e)}fireAtPointer(t){var e,i;return void 0===t&&this.scene.input&&(t=this.scene.input.activePointer),this.fire(null,null===(e=t)||void 0===e?void 0:e.x,null===(i=t)||void 0===i?void 0:i.y)}fireAtSprite(t){return this.fire(null,null==t?void 0:t.x,null==t?void 0:t.y)}fireAtXY(t,e){return this.fire(null,t,e)}fire(t,e,i,r=0,s=0){var o;if(this.scene.time.now<this._nextFire||this.fireLimit>0&&this.shots===this.fireLimit)return;let a=this.bulletSpeed;0!==this.bulletSpeedVariance&&(a+=Phaser.Math.Between(-this.bulletSpeedVariance,this.bulletSpeedVariance)),t?this.updateFireFrom(t.x,t.y):this.trackedSprite&&"number"==typeof this.trackedSprite.rotation?(this.trackRotation?(this._rotatedPoint.set(this.trackedSprite.x+this.trackOffset.x,this.trackedSprite.y+this.trackOffset.y),Phaser.Math.RotateAround(this._rotatedPoint,this.trackedSprite.x,this.trackedSprite.y,this.trackedSprite.rotation),this.updateFireFrom(this._rotatedPoint.x,this._rotatedPoint.y)):this.updateFireFrom(this.trackedSprite.x,this.trackedSprite.y),this.bulletInheritSpriteSpeed&&this.trackedSprite.body&&(a+=this.trackedSprite.body.speed)):this.trackedPointer&&this.updateFireFrom(this.trackedPointer.x,this.trackedPointer.y),this.fireFrom.x+=r,this.fireFrom.y+=s;const u=this.fireFrom.width>1?this.fireFrom.x+Math.random()*this.fireFrom.width:this.fireFrom.x,c=this.fireFrom.height>1?this.fireFrom.y+Math.random()*this.fireFrom.height:this.fireFrom.y;let h="number"==typeof(null===(o=this.trackedSprite)||void 0===o?void 0:o.angle)&&this.trackRotation?this.trackedSprite.angle:this.fireAngle;"number"==typeof e&&"number"==typeof i&&(h=Phaser.Math.RadToDeg(Math.atan2(i-c,e-u))),0!==this.bulletAngleVariance&&(h+=Phaser.Math.Between(-this.bulletAngleVariance,this.bulletAngleVariance));let f,d=0,p=0;var b;(0===h||180===h?d=Math.cos(Phaser.Math.DegToRad(h))*a:(90===h||270===h||(d=Math.cos(Phaser.Math.DegToRad(h))*a),p=Math.sin(Phaser.Math.DegToRad(h))*a),this.autoExpandBulletsGroup)?(f=this.bullets.getFirstDead(!0,u,c,this.bulletKey,this.bulletFrame),null===(b=f)||void 0===b||b.setData("bulletManager",this)):f=this.bullets.getFirstDead(!1);if(void 0!==f){if(f.prepare(u,c),f.setData({fromX:u,fromY:c,killType:this.bulletKillType,killDistance:this.bulletKillDistance,rotateToVelocity:this.bulletRotateToVelocity}),this.bulletKillType===n.KillType.KILL_LIFESPAN&&(f.setData("timeEvent",this.scene.time.addEvent({delay:this.bulletLifespan,callback:f.kill,callbackScope:f})),f.lifespan=this.bulletLifespan),f.angle=h+this.bulletAngleOffset,this.bulletAnimation)f.anims.play(this.bulletAnimation);else if(this.bulletFrameCycle)this.bulletFrameIndex>=this.bulletFrames.length&&(this.bulletFrameIndex=0),f.setTexture(this.bulletKey,this.bulletFrameIndex),this.bulletFrameIndex++;else if(this.bulletFrameRandom){const t=Math.floor(Math.random()*this.bulletFrames.length);f.setTexture(this.bulletKey,t)}f.getData("bodyDirty")&&(this._data.customBody&&(f.body.setSize(this._data.width,this._data.height),f.body.setOffset(this._data.offsetX,this._data.offsetY)),f.body.collideWorldBounds=this.bulletCollideWorldBounds,f.setData("bodyDirty",!1)),f.body.setVelocity(d,p),f.body.setGravity(this.bulletGravity.x,this.bulletGravity.y);let t=0;if(0!==this.bulletSpeedVariance){let e=this.fireRate;e+=Phaser.Math.Between(-this.fireRateVariance,this.fireRateVariance),e<0&&(e=0),t=this.scene.time.now+e}else t=this.scene.time.now+this.fireRate;this.multiFire?this._hasFired||(this._hasFired=!0,this._tempNextFire=t,this.shots++):(this._nextFire=t,this.shots++),this.emit(l.WEAPON_FIRE,f,this,a),this.fireLimit>0&&this.shots===this.fireLimit&&this.emit(l.WEAPON_FIRE_LIMIT,this,this.fireLimit)}return f}updateFireFrom(t,e){this.fireFrom.width>1?Phaser.Geom.Rectangle.CenterOn(this.fireFrom,t+this.trackOffset.x,e+this.trackOffset.y):(this.fireFrom.x=t+this.trackOffset.x,this.fireFrom.y=e+this.trackOffset.y)}setBulletBodyOffset(t,e,i=0,r=0){return this._data.customBody=!0,this._data.width=t,this._data.height=e,this._data.offsetX=i,this._data.offsetY=r,this.bullets.children.each(n=>{n.body.setSize(t,e),n.body.setOffset(i,r),n.setData("bodyDirty",!1)}),this}setBulletFrames(t,e,i=n.FrameType.BULLET_FRAME_STABLE){return("number"!=typeof i||i<n.FrameType.BULLET_FRAME_STABLE||i>n.FrameType.BULLET_FRAME_RANDOM)&&Object(s.log)("Invalid bullet frame selection method specified: "+i,this.logLevel),t>e&&Object(s.log)(`min frame (${t}) must be <= max frame (${e})`,this.logLevel),this.bulletFrames=Phaser.Utils.Array.NumberArray(t,e),this.bulletFrameIndex=0,this.bulletFrameCycle=i===n.FrameType.BULLET_FRAME_CYCLE,this.bulletFrameRandom=i===n.FrameType.BULLET_FRAME_RANDOM,this}addBulletAnimation(t,e,i=60,r=0){return this.scene.sys.anims.exists(t)||(this.scene.sys.anims.create({key:t,frames:e,frameRate:i,repeat:r}),this.anims[t]=this.scene.sys.anims.get(t)),this.bulletAnimation=t,this}update(){this._bulletKillType===n.KillType.KILL_WEAPON_BOUNDS&&(this.trackedSprite?Phaser.Geom.Rectangle.CenterOn(this.bounds,this.trackedSprite.x,this.trackedSprite.y):this.trackedPointer&&Phaser.Geom.Rectangle.CenterOn(this.bounds,this.trackedPointer.x,this.trackedPointer.y)),this.autofire&&this.fire()}postRender(){this.multiFire&&this._hasFired&&(this._hasFired=!1,this._nextFire=this._tempNextFire)}destroy(){this.scene=void 0,this.bullets.destroy(!0)}}e.default=o},function(t,e,i){var r=i(3),n=i(5),s=i(6),l=i(18),o=i(13),a=o("iterator"),u=o("toStringTag"),c=s.values;for(var h in n){var f=r[h],d=f&&f.prototype;if(d){if(d[a]!==c)try{l(d,a,c)}catch(b){d[a]=c}if(d[u]||l(d,u,h),n[h])for(var p in s)if(d[p]!==s[p])try{l(d,p,s[p])}catch(b){d[p]=s[p]}}}},function(t,e,i){(function(e){var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof e&&e)||Function("return this")()}).call(this,i(4))},function(t,e){var i;i=function(){return this}();try{i=i||new Function("return this")()}catch(r){"object"==typeof window&&(i=window)}t.exports=i},function(t,e){t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},function(t,e,i){"use strict";var r=i(7),n=i(12),s=i(45),l=i(46),o=i(49),a=l.set,u=l.getterFor("Array Iterator");t.exports=o(Array,"Array",(function(t,e){a(this,{type:"Array Iterator",target:r(t),index:0,kind:e})}),(function(){var t=u(this),e=t.target,i=t.kind,r=t.index++;return!e||r>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==i?{value:r,done:!1}:"values"==i?{value:e[r],done:!1}:{value:[r,e[r]],done:!1}}),"values"),s.Arguments=s.Array,n("keys"),n("values"),n("entries")},function(t,e,i){var r=i(8),n=i(11);t.exports=function(t){return r(n(t))}},function(t,e,i){var r=i(9),n=i(10),s="".split;t.exports=r((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==n(t)?s.call(t,""):Object(t)}:Object},function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},function(t,e){var i={}.toString;t.exports=function(t){return i.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},function(t,e,i){var r=i(13),n=i(31),s=i(20),l=r("unscopables"),o=Array.prototype;null==o[l]&&s.f(o,l,{configurable:!0,value:n(null)}),t.exports=function(t){o[l][t]=!0}},function(t,e,i){var r=i(3),n=i(14),s=i(27),l=i(28),o=i(29),a=i(30),u=n("wks"),c=r.Symbol,h=a?c:c&&c.withoutSetter||l;t.exports=function(t){return s(u,t)||(o&&s(c,t)?u[t]=c[t]:u[t]=h("Symbol."+t)),u[t]}},function(t,e,i){var r=i(15),n=i(16);(t.exports=function(t,e){return n[t]||(n[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.6.5",mode:r?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})},function(t,e){t.exports=!1},function(t,e,i){var r=i(3),n=i(17),s=r["__core-js_shared__"]||n("__core-js_shared__",{});t.exports=s},function(t,e,i){var r=i(3),n=i(18);t.exports=function(t,e){try{n(r,t,e)}catch(i){r[t]=e}return e}},function(t,e,i){var r=i(19),n=i(20),s=i(26);t.exports=r?function(t,e,i){return n.f(t,e,s(1,i))}:function(t,e,i){return t[e]=i,t}},function(t,e,i){var r=i(9);t.exports=!r((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},function(t,e,i){var r=i(19),n=i(21),s=i(24),l=i(25),o=Object.defineProperty;e.f=r?o:function(t,e,i){if(s(t),e=l(e,!0),s(i),n)try{return o(t,e,i)}catch(r){}if("get"in i||"set"in i)throw TypeError("Accessors not supported");return"value"in i&&(t[e]=i.value),t}},function(t,e,i){var r=i(19),n=i(9),s=i(22);t.exports=!r&&!n((function(){return 7!=Object.defineProperty(s("div"),"a",{get:function(){return 7}}).a}))},function(t,e,i){var r=i(3),n=i(23),s=r.document,l=n(s)&&n(s.createElement);t.exports=function(t){return l?s.createElement(t):{}}},function(t,e){t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},function(t,e,i){var r=i(23);t.exports=function(t){if(!r(t))throw TypeError(String(t)+" is not an object");return t}},function(t,e,i){var r=i(23);t.exports=function(t,e){if(!r(t))return t;var i,n;if(e&&"function"==typeof(i=t.toString)&&!r(n=i.call(t)))return n;if("function"==typeof(i=t.valueOf)&&!r(n=i.call(t)))return n;if(!e&&"function"==typeof(i=t.toString)&&!r(n=i.call(t)))return n;throw TypeError("Can't convert object to primitive value")}},function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},function(t,e){var i={}.hasOwnProperty;t.exports=function(t,e){return i.call(t,e)}},function(t,e){var i=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++i+r).toString(36)}},function(t,e,i){var r=i(9);t.exports=!!Object.getOwnPropertySymbols&&!r((function(){return!String(Symbol())}))},function(t,e,i){var r=i(29);t.exports=r&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},function(t,e,i){var r,n=i(24),s=i(32),l=i(40),o=i(39),a=i(41),u=i(22),c=i(44),h=c("IE_PROTO"),f=function(){},d=function(t){return"<script>"+t+"<\/script>"},p=function(){try{r=document.domain&&new ActiveXObject("htmlfile")}catch(n){}var t,e;p=r?function(t){t.write(d("")),t.close();var e=t.parentWindow.Object;return t=null,e}(r):((e=u("iframe")).style.display="none",a.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(d("document.F=Object")),t.close(),t.F);for(var i=l.length;i--;)delete p.prototype[l[i]];return p()};o[h]=!0,t.exports=Object.create||function(t,e){var i;return null!==t?(f.prototype=n(t),i=new f,f.prototype=null,i[h]=t):i=p(),void 0===e?i:s(i,e)}},function(t,e,i){var r=i(19),n=i(20),s=i(24),l=i(33);t.exports=r?Object.defineProperties:function(t,e){s(t);for(var i,r=l(e),o=r.length,a=0;o>a;)n.f(t,i=r[a++],e[i]);return t}},function(t,e,i){var r=i(34),n=i(40);t.exports=Object.keys||function(t){return r(t,n)}},function(t,e,i){var r=i(27),n=i(7),s=i(35).indexOf,l=i(39);t.exports=function(t,e){var i,o=n(t),a=0,u=[];for(i in o)!r(l,i)&&r(o,i)&&u.push(i);for(;e.length>a;)r(o,i=e[a++])&&(~s(u,i)||u.push(i));return u}},function(t,e,i){var r=i(7),n=i(36),s=i(38),l=function(t){return function(e,i,l){var o,a=r(e),u=n(a.length),c=s(l,u);if(t&&i!=i){for(;u>c;)if((o=a[c++])!=o)return!0}else for(;u>c;c++)if((t||c in a)&&a[c]===i)return t||c||0;return!t&&-1}};t.exports={includes:l(!0),indexOf:l(!1)}},function(t,e,i){var r=i(37),n=Math.min;t.exports=function(t){return t>0?n(r(t),9007199254740991):0}},function(t,e){var i=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:i)(t)}},function(t,e,i){var r=i(37),n=Math.max,s=Math.min;t.exports=function(t,e){var i=r(t);return i<0?n(i+e,0):s(i,e)}},function(t,e){t.exports={}},function(t,e){t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},function(t,e,i){var r=i(42);t.exports=r("document","documentElement")},function(t,e,i){var r=i(43),n=i(3),s=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?s(r[t])||s(n[t]):r[t]&&r[t][e]||n[t]&&n[t][e]}},function(t,e,i){var r=i(3);t.exports=r},function(t,e,i){var r=i(14),n=i(28),s=r("keys");t.exports=function(t){return s[t]||(s[t]=n(t))}},function(t,e){t.exports={}},function(t,e,i){var r,n,s,l=i(47),o=i(3),a=i(23),u=i(18),c=i(27),h=i(44),f=i(39),d=o.WeakMap;if(l){var p=new d,b=p.get,y=p.has,_=p.set;r=function(t,e){return _.call(p,t,e),e},n=function(t){return b.call(p,t)||{}},s=function(t){return y.call(p,t)}}else{var m=h("state");f[m]=!0,r=function(t,e){return u(t,m,e),e},n=function(t){return c(t,m)?t[m]:{}},s=function(t){return c(t,m)}}t.exports={set:r,get:n,has:s,enforce:function(t){return s(t)?n(t):r(t,{})},getterFor:function(t){return function(e){var i;if(!a(e)||(i=n(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return i}}}},function(t,e,i){var r=i(3),n=i(48),s=r.WeakMap;t.exports="function"==typeof s&&/native code/.test(n(s))},function(t,e,i){var r=i(16),n=Function.toString;"function"!=typeof r.inspectSource&&(r.inspectSource=function(t){return n.call(t)}),t.exports=r.inspectSource},function(t,e,i){"use strict";var r=i(50),n=i(59),s=i(61),l=i(65),o=i(64),a=i(18),u=i(53),c=i(13),h=i(15),f=i(45),d=i(60),p=d.IteratorPrototype,b=d.BUGGY_SAFARI_ITERATORS,y=c("iterator"),_=function(){return this};t.exports=function(t,e,i,c,d,m,v){n(i,e,c);var g,L,S,O=function(t){if(t===d&&x)return x;if(!b&&t in T)return T[t];switch(t){case"keys":case"values":case"entries":return function(){return new i(this,t)}}return function(){return new i(this)}},E=e+" Iterator",F=!1,T=t.prototype,A=T[y]||T["@@iterator"]||d&&T[d],x=!b&&A||O(d),P="Array"==e&&T.entries||A;if(P&&(g=s(P.call(new t)),p!==Object.prototype&&g.next&&(h||s(g)===p||(l?l(g,p):"function"!=typeof g[y]&&a(g,y,_)),o(g,E,!0,!0),h&&(f[E]=_))),"values"==d&&A&&"values"!==A.name&&(F=!0,x=function(){return A.call(this)}),h&&!v||T[y]===x||a(T,y,x),f[e]=x,d)if(L={values:O("values"),keys:m?x:O("keys"),entries:O("entries")},v)for(S in L)(b||F||!(S in T))&&u(T,S,L[S]);else r({target:e,proto:!0,forced:b||F},L);return L}},function(t,e,i){var r=i(3),n=i(51).f,s=i(18),l=i(53),o=i(17),a=i(54),u=i(58);t.exports=function(t,e){var i,c,h,f,d,p=t.target,b=t.global,y=t.stat;if(i=b?r:y?r[p]||o(p,{}):(r[p]||{}).prototype)for(c in e){if(f=e[c],h=t.noTargetGet?(d=n(i,c))&&d.value:i[c],!u(b?c:p+(y?".":"#")+c,t.forced)&&void 0!==h){if(typeof f==typeof h)continue;a(f,h)}(t.sham||h&&h.sham)&&s(f,"sham",!0),l(i,c,f,t)}}},function(t,e,i){var r=i(19),n=i(52),s=i(26),l=i(7),o=i(25),a=i(27),u=i(21),c=Object.getOwnPropertyDescriptor;e.f=r?c:function(t,e){if(t=l(t),e=o(e,!0),u)try{return c(t,e)}catch(i){}if(a(t,e))return s(!n.f.call(t,e),t[e])}},function(t,e,i){"use strict";var r={}.propertyIsEnumerable,n=Object.getOwnPropertyDescriptor,s=n&&!r.call({1:2},1);e.f=s?function(t){var e=n(this,t);return!!e&&e.enumerable}:r},function(t,e,i){var r=i(3),n=i(18),s=i(27),l=i(17),o=i(48),a=i(46),u=a.get,c=a.enforce,h=String(String).split("String");(t.exports=function(t,e,i,o){var a=!!o&&!!o.unsafe,u=!!o&&!!o.enumerable,f=!!o&&!!o.noTargetGet;"function"==typeof i&&("string"!=typeof e||s(i,"name")||n(i,"name",e),c(i).source=h.join("string"==typeof e?e:"")),t!==r?(a?!f&&t[e]&&(u=!0):delete t[e],u?t[e]=i:n(t,e,i)):u?t[e]=i:l(e,i)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||o(this)}))},function(t,e,i){var r=i(27),n=i(55),s=i(51),l=i(20);t.exports=function(t,e){for(var i=n(e),o=l.f,a=s.f,u=0;u<i.length;u++){var c=i[u];r(t,c)||o(t,c,a(e,c))}}},function(t,e,i){var r=i(42),n=i(56),s=i(57),l=i(24);t.exports=r("Reflect","ownKeys")||function(t){var e=n.f(l(t)),i=s.f;return i?e.concat(i(t)):e}},function(t,e,i){var r=i(34),n=i(40).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return r(t,n)}},function(t,e){e.f=Object.getOwnPropertySymbols},function(t,e,i){var r=i(9),n=/#|\.prototype\./,s=function(t,e){var i=o[l(t)];return i==u||i!=a&&("function"==typeof e?r(e):!!e)},l=s.normalize=function(t){return String(t).replace(n,".").toLowerCase()},o=s.data={},a=s.NATIVE="N",u=s.POLYFILL="P";t.exports=s},function(t,e,i){"use strict";var r=i(60).IteratorPrototype,n=i(31),s=i(26),l=i(64),o=i(45),a=function(){return this};t.exports=function(t,e,i){var u=e+" Iterator";return t.prototype=n(r,{next:s(1,i)}),l(t,u,!1,!0),o[u]=a,t}},function(t,e,i){"use strict";var r,n,s,l=i(61),o=i(18),a=i(27),u=i(13),c=i(15),h=u("iterator"),f=!1;[].keys&&("next"in(s=[].keys())?(n=l(l(s)))!==Object.prototype&&(r=n):f=!0),null==r&&(r={}),c||a(r,h)||o(r,h,(function(){return this})),t.exports={IteratorPrototype:r,BUGGY_SAFARI_ITERATORS:f}},function(t,e,i){var r=i(27),n=i(62),s=i(44),l=i(63),o=s("IE_PROTO"),a=Object.prototype;t.exports=l?Object.getPrototypeOf:function(t){return t=n(t),r(t,o)?t[o]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?a:null}},function(t,e,i){var r=i(11);t.exports=function(t){return Object(r(t))}},function(t,e,i){var r=i(9);t.exports=!r((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},function(t,e,i){var r=i(20).f,n=i(27),s=i(13)("toStringTag");t.exports=function(t,e,i){t&&!n(t=i?t:t.prototype,s)&&r(t,s,{configurable:!0,value:e})}},function(t,e,i){var r=i(24),n=i(66);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,i={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(i,[]),e=i instanceof Array}catch(s){}return function(i,s){return r(i),n(s),e?t.call(i,s):i.__proto__=s,i}}():void 0)},function(t,e,i){var r=i(23);t.exports=function(t){if(!r(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},function(t,e,i){"use strict";i.r(e);var r=i(68),n=i(69);let s=0;class l extends Phaser.GameObjects.Sprite{constructor(t,e,i,n,l){super(t,e,i,n,l),this.body=void 0,this.bulletID=void 0,this.lifespan=void 0,this.bulletID=s,s++,this.scene.physics.add.existing(this),this.setDataEnabled(),this.setData({timeEvent:void 0,bulletManager:void 0,fromX:0,fromY:0,bodyDirty:!0,rotateToVelocity:!1,killType:r.KillType.KILL_NEVER,killDistance:0,bodyBounds:new Phaser.Geom.Rectangle})}setData(t,e){return super.setData(t,e)}getData(t){return super.getData(t)}prepare(t,e){var i;this.setActive(!0),this.setVisible(!0),this.body.enable=!0,this.body.reset(t,e);const r=(null===(i=this.getData("bulletManager"))||void 0===i?void 0:i.debugPhysics)||!1;this.body.debugShowBody=r,this.body.debugShowVelocity=r}kill(){var t;this.body.stop(),this.body.enable=!1,this.setActive(!1),this.setVisible(!1),this.body.debugShowBody=!1,this.body.debugShowVelocity=!1;const e=this.getData("timeEvent");return void 0!==e&&(e.destroy(),this.setData("timeEvent",void 0)),null===(t=this.getData("bulletManager"))||void 0===t||t.emit(n.BULLET_KILL,this,this.getData("bulletManager")),this}update(){if(!this.active)return;const t=this.getData("bulletManager");this.getData("killType")>r.KillType.KILL_LIFESPAN&&(this.getData("killType")===r.KillType.KILL_DISTANCE?new Phaser.Math.Vector2(this.getData("fromX"),this.getData("fromY")).distance(this)>this.getData("killDistance")&&this.kill():Phaser.Geom.Intersects.RectangleToRectangle(t.bulletBounds,this.body.getBounds(this.getData("bodyBounds")))||this.kill()),this.getData("rotateToVelocity")&&(this.rotation=Math.atan2(this.body.velocity.y,this.body.velocity.x)),t.bulletWorldWrap&&this.scene.physics.world.wrap(this,t.bulletWorldWrapPadding)}}e.default=l},function(t,e,i){"use strict";var r,n,s;i.r(e),i.d(e,"KillType",(function(){return r})),i.d(e,"Angle",(function(){return n})),i.d(e,"FrameType",(function(){return s})),function(t){t[t.KILL_NEVER=0]="KILL_NEVER",t[t.KILL_LIFESPAN=1]="KILL_LIFESPAN",t[t.KILL_DISTANCE=2]="KILL_DISTANCE",t[t.KILL_WEAPON_BOUNDS=3]="KILL_WEAPON_BOUNDS",t[t.KILL_CAMERA_BOUNDS=4]="KILL_CAMERA_BOUNDS",t[t.KILL_WORLD_BOUNDS=5]="KILL_WORLD_BOUNDS",t[t.KILL_STATIC_BOUNDS=6]="KILL_STATIC_BOUNDS"}(r||(r={})),function(t){t[t.ANGLE_UP=270]="ANGLE_UP",t[t.ANGLE_DOWN=90]="ANGLE_DOWN",t[t.ANGLE_LEFT=180]="ANGLE_LEFT",t[t.ANGLE_RIGHT=0]="ANGLE_RIGHT",t[t.ANGLE_NORTH_EAST=315]="ANGLE_NORTH_EAST",t[t.ANGLE_NORTH_WEST=225]="ANGLE_NORTH_WEST",t[t.ANGLE_SOUTH_EAST=45]="ANGLE_SOUTH_EAST",t[t.ANGLE_SOUTH_WEST=135]="ANGLE_SOUTH_WEST"}(n||(n={})),function(t){t[t.BULLET_FRAME_STABLE=0]="BULLET_FRAME_STABLE",t[t.BULLET_FRAME_CYCLE=1]="BULLET_FRAME_CYCLE",t[t.BULLET_FRAME_RANDOM=2]="BULLET_FRAME_RANDOM"}(s||(s={})),e.default={KillType:r,Angle:n,FrameType:s}},function(t,e,i){"use strict";i.r(e),i.d(e,"WEAPON_FIRE",(function(){return r})),i.d(e,"WEAPON_FIRE_LIMIT",(function(){return n})),i.d(e,"BULLET_KILL",(function(){return s}));const r="fire",n="firelimit",s="kill";e.default={WEAPON_FIRE:r,WEAPON_FIRE_LIMIT:n,BULLET_KILL:s}},function(t,e,i){"use strict";i.r(e),i.d(e,"log",(function(){return n}));var r=i(68);function n(t,e){if("warn"===e)console.warn(t);else if("error"===e)throw new Error(t)}e.default=function(t,e="all"){var i,s;!["bulletWorldWrap","bulletKillType"].includes(e)&&"all"!==e||!t.bulletWorldWrap||t.bulletKillType!==r.default.KillType.KILL_WORLD_BOUNDS&&t.bulletKillType!==r.default.KillType.KILL_WEAPON_BOUNDS||n("Warning: KILL_WORLD_BOUNDS and KILL_WEAPON_BOUNDS does not work well with bulletWorldWrap set to true.",t.logLevel),(["bulletKillType","bulletLifespan"].includes(e)||"all"===e)&&t.bulletKillType===r.default.KillType.KILL_LIFESPAN&&t.bulletLifespan<0&&n("Invalid bulletLifespan; must be > 0; currently "+t.bulletLifespan,t.logLevel),!["trackRotation","trackedSprite"].includes(e)&&"all"!==e||!0!==t.trackRotation||void 0!==(null===(i=t.trackedSprite)||void 0===i?void 0:i.rotation)&&void 0!==t.trackedSprite.angle||n("Warning: Weapon cannot track rotation of an object without a rotation and/or angle property.",t.logLevel),!["bulletInheritSpriteSpeed","trackedSprite"].includes(e)&&"all"!==e||!0!==t.bulletInheritSpriteSpeed||(null===(s=t.trackedSprite)||void 0===s?void 0:s.body)||n("Warning: Bullet cannot inherit speed from a sprite without a body.",t.logLevel);const l=["fireLimit","fireRate","fireRateVariance","bulletAngleVariance","bulletSpeedVariance","bulletKillDistance"];"all"===e?l.forEach(i=>{void 0!==t[i]&&t[i]<0&&n("Invalid "+e+"; must be >= 0; currently "+t[i],t.logLevel)}):l.includes(e)&&void 0!==t[e]&&t[e]<0&&n("Invalid "+e+"; must be >= 0; currently "+t[e],t.logLevel)}},function(t,e,i){"use strict";i.r(e);var r=i(1);class n extends Phaser.Plugins.ScenePlugin{constructor(t,e){super(t,e),this.weapons=void 0,this.weapons=[],e.registerGameObject("weapon",this.add.bind(this),t=>this.add(t.bulletLimit,t.key,t.frame,t.group,t.weaponClass))}add(t,e,i,n,s=r.default){const l=new s(this.scene,t,e,i,n);return this.weapons.push(l),l}start(){this.systems.events.on(Phaser.Core.Events.POST_RENDER,this.postRender,this)}boot(){const t=this.systems.events;t.on(Phaser.Scenes.Events.UPDATE,this.update,this),t.on(Phaser.Core.Events.DESTROY,this.destroy,this)}update(){this.weapons.forEach(t=>{t.update()})}postRender(){this.weapons.forEach(t=>{t.postRender()})}destroy(){super.destroy(),this.weapons.forEach(t=>{t.destroy()})}}e.default=n}])}));
//# sourceMappingURL=WeaponPlugin.modern.min.js.map